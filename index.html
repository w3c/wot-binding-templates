<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta charset="utf-8" />
  <title>Web of Things (WoT) Binding Templates</title>
  <script class="remove" async="" src="https://www.w3.org/Tools/respec/respec-w3c-common"></script>
  <script class="remove">
    var respecConfig = {
      specStatus: "ED",
      processVersion: 2017,
      shortName: "wot-binding-templates",
      copyrightStart: 2017,
      wg: "Web of Things Working Group",
      wgURI: "https://www.w3.org/WoT/WG/",
      wgPublicList: "public-wot-wg",
      edDraftURI: "https://w3c.github.io/wot-binding-templates/",
      githubAPI: "https://api.github.com/repos/w3c/wot-binding-templates",
      issueBase: "https://www.github.com/w3c/wot-binding-templates/issues",
      editors: [{
          name: "Michael Koster",
          w3cid: "110658",
          company: "SmartThings",
          companyURL: "https://www.smartthings.com/"
        },
        {
          name: "Ege Korkan",
          w3cid: "110131",
          company: "Siemens AG",
          companyURL: "https://www.siemens.com/"
        }
      ],
      otherLinks: [{
        key: "Contributors",
        data: [{
          value: "In the GitHub repository",
          href: "https://github.com/w3c/wot-binding-templates/graphs/contributors"
        }]
      }, {
        key: "Repository",
        data: [{
          value: "We are on GitHub",
          href: "https://github.com/w3c/wot-binding-templates/"
        }, {
          value: "File a bug",
          href: "https://github.com/w3c/wot-binding-templates/issues"
        }]
      }],
      localBiblio: {
        "CoRE-RD": {
          href: "https://tools.ietf.org/html/draft-ietf-core-resource-directory-11",
          title: "CoRE Resource Directory",
          status: "Internet-Draft",
          publisher: "IETF",
          date: "03 July 2017"
        },
        "wot-security-guidelines":{
          href:"https://w3c.github.io/wot-security/",
          title: "Web of Things (WoT) Security and Privacy Guidelines",
          status: "W3C Editor's Draft",
          publisher: "W3C",
          date: "21 August 2019"
        },
        "iana-web-socket-registry":{
          href: "https://www.iana.org/assignments/websocket/websocket.xml#subprotocol-name",
          title: "IANA Registry for Websocket Subprotocols",
          status: "",
          publisher: "IANA",
          date: "24 May 2019"
        },
        "MQTT": {
          href: "https://docs.oasis-open.org/mqtt/mqtt/v5.0/mqtt-v5.0.html",
          title: "MQTT Version 5.0",
          status: "",
          publisher: "MQTT",
          date: "07 March 2019",
          authors: [
            "Andrew Banks", "Ed Briggs", "Ken Borgendale", "Rahul Gupta"
        ]
        },
        "LWM2M":{
          href: "https://www.omaspecworks.org/what-is-oma-specworks/iot/lightweight-m2m-lwm2m/",
          title: "Lightweight M2M",
          status: "",
          publisher:"Open Mobility Alliance"
        },
        "OCF":{
          href: "https://openconnectivity.org/developer/specifications/",
          title: "OCF Specification",
          publisher: "Open Connectivity Foundation",
          date:"Last accessed: February 2020"
        },
        "Modbus":{
          href: "https://modbus.org/specs.php",
          title: "MODBUS APPLICATION PROTOCOL SPECIFICATION",
          publisher: "Modbus Organization",
          status: "",
          date: "26 April 2012"
        }
      }
    };
  </script>
</head>

<body>

  <section id="abstract">
    <p>
      W3C Web of Things enables applications to interact with and orchestrate
      connected Things at Web scale. The standardized abstract interaction
      model exposed by the WoT Thing Description enables applications to scale and
      evolve independently of the individual Things.
    </p>
    <p>
      Many network-level protocols and standards for connected Things have
      already been developed, and have millions of devices deployed in the
      field today. These standards are converging on a common set of transport
      protocols and transfer layers, but each has peculiar content formats,
      payload schemas, and data types.
    </p>
    <p>
      Despite using unique formats and data models, the high-level interactions
      exposed by most connected things can be modeled using the Property, Action,
      and Event interaction affordances of the WoT Thing Description.
    </p>
    <p>
      Binding Templates enable a Thing Description to be adapted to
      the specific protocol or data payload usage across the different standards. This is done
      through additional descriptive vocabulary that is used in the Thing Description.
    </p>
    <p>
      This document describes the initial set of vocabulary
      extensions to the WoT Thing Description that make up the Binding
      Templates. It is expected over time that additional protocols and payload structures will be
      accommodated by further extending the Binding Templates.
    </p>
  </section>


  <section id="sotd">
    <p class="ednote" title="The W3C WoT WG is asking for feedback">
      Please contribute to this draft using the
      <a href="https://github.com/w3c/wot-binding-templates/issues">GitHub Issue</a>
      feature of the <a href="https://github.com/w3c/wot-binding-templates/">
        WoT Binding Templates</a> repository.
      For feedback on security and privacy considerations, please use the
      <a href="https://github.com/w3c/wot-security/issues">WoT Security and Privacy</a>
      Issues, as they are cross-cutting over all our documents.
    </p>
  </section>


  <section>
    <h1>Introduction</h1>
    <p>
      Binding Templates consist of reusable vocabulary and extensions to the WoT Thing Description[[WOT-THING-DESCRIPTION]] format that enable an application client (a Consumer) to interact, using a consistent interaction model, with Things that expose diverse protocols and protocol usage.
    </p>

      <p>
        Binding Templates enable Consumers to adapt to the underlying
        protocol and network-facing API constructions. Once the base protocol
        (e.g., HTTP[[?RFC7231]], CoAP[[?RFC7252]], MQTT[[?MQTT]], etc.) is identified, the following adaptions
        specify the particular use within the given platform.
      </p>
      <p class="ednote" title="Additional Protocol Bindings">
        This document contains examples of Protocol Bindings for HTTP, CoAP,
        and MQTT. Other protocols may be added following the same design style
        and using payload mappings that can be expressed as JSON compatible
        entities. Future extensions to other payload definition formats are
        also contemplated.
      </p>

      <section>
        <h3>Protocol Methods and Options</h3>
        <p>
          Most protocols have a relatively small set of methods that define
          the message type, the semantic intention of the message.
          REST and PubSub architecture patterns result in different protocols with different methods.
          Common methods found in these protocols are GET, PUT, POST, DELETE, PUBLISH, and SUBSCRIBE.
          Binding Templates describe how these existing methods and vocabularies can be described in a Thing Description.
        </p>
        <p>
          This is done by mapping the protocol methods to the abstract WoT Interaction Affordance terms
          <code>readproperty</code>, <code>writeproperty</code>,
          <code>observeproperty</code>, <code>unobserveproperty</code>, <code>invokeaction</code>,
          <code>subscribeevent</code>, <code>unsubscribeevent</code>,
          <code>readallproperties</code>, <code>writeallproperties</code>,
          <code>readmultipleproperties</code>, <code>writemultipleproperties</code>.
          <!-- modifyAction, cancelAction is still undefined -->
        </p>
        <p>
          Possible protocol options are also specified in the Protocol Binding.
          They are used to select transfer modes, to request notifications from
          observable resources, or otherwise extend the semantics of the protocol
          methods.
        </p>
      </section>

      <section>
        <h3>Media Types</h3>
        <p>
          Maximum use should be made of IANA-registered Media Types [[IANA-MEDIA-TYPES]] (e.g.,
          <code>application/json</code>) in order to decouple applications from connected Things. 
          Standard bridges and translations from proprietary formats to Web-friendly languages 
          such as JSON and XML are part of the adaptation needed.
        </p>
        <p>
          Correct indication of Media Types enables proper processing of the serialized documents.
          This way, the documents can be exchanged in any format and allow the upper layers of an application
          to adapt to different formats.
        </p>
      </section>

      <section>
        <h3>Payload Structure</h3>
        <p>
          Data serialized to a standard Media Type still remains in a structure
          specific to the platform data model and needs to be understood by
          Consumers (cf. various types of JSON documents).
        </p>
        <p>
          The data definition language of <code>DataSchema</code>
          elements, described in [[WOT-THING-DESCRIPTION]], allows for describing arbitrary
          structures by nesting of arrays and objects. Constants and
          variable specifications may be intermixed.
        </p>
      </section>

      <section>
        <h3>Data Types and Value Constraints</h3>
        <p>
          Simple data types and value constraints are currently used in a layered
          and descriptive way in [[WOT-THING-DESCRIPTION]]. Additional forms of
          constraints are available to help adapt to the underlying data types.
          A platform-specific 8-bit unsigned integer, for instance, can be defined
          as Integer with a minimum of 0 and maximum of 255; the system-specific
          representation (e.g., exact number of bits) on the Thing and the Consumer is not
          relevant for interoperability.
        </p>
      </section>
  </section>

  <section id="conformance"></section>

  <section id="terminology" class="informative">
    <h2>Terminology</h2>

    <p>The fundamental WoT terminology such as
      <dfn>Thing</dfn>,
      <dfn>Consumer</dfn>,
      <dfn>Thing Description</dfn> (<dfn>TD</dfn>),
      <dfn>Interaction Model</dfn>,
      <dfn>Interaction Affordance</dfn>,
      <dfn>Property</dfn>,
      <dfn>Action</dfn>,
      <dfn>Event</dfn>,
      <dfn>Protocol Binding</dfn>,
      <dfn>Servient</dfn>,
      <dfn>Vocabulary</dfn>,
      <dfn>WoT Interface</dfn>,
      <dfn>WoT Runtime</dfn>,
      etc. is defined in <a href="https://w3c.github.io/wot-architecture/#terminology">Section 3</a>
      of the WoT Architecture specification [[WOT-ARCHITECTURE]].
    </p>

  </section>

  <section id="binding-overview" class="informative">
    <h1>Binding Templates Overview</h1>
    <p>
      This section describes the mechanisms of binding templates with
      examples.
    </p>

    <section id="sec-data-schema">
      <h2>Data Schema</h2>
      <p>
        A data schema describes the payload structure and included
        data items that are passed between the Consumer and the Thing during interactions.
      </p>

      <section id="payload-structure">
        <h2>Payload Structure</h2>
        <p>
          Payload Structure is determined by <code>DataSchema</code> elements of a Thing Description.
          DataSchema elements should be used by an instance of a <code>PropertyAffordance</code>,
          <code>input</code>/<code>output</code> of <code>ActionAffordance</code>,
          <code>data</code>/<code>subscription</code>/<code>cancellation</code> of an <code>EventAffordance</code> or by
          a <code>uriVariable</code> of the <code>InteractionAffordance</code>.
          As indicated in the [[WOT-THING-DESCRIPTION]], <code>DataSchema</code> Vocabulary is a subset of JSON Schema [[json-schema]]
        </p>
        <p>
          In the case of Action Affordances, the additional keywords <code>input</code> and
          <code>output</code> are used to provide two different schemas when data
          might be exchanged in both directions, such as in the case of invoking an Action Affordance
          with input parameters and receiving status information.
        </p>
        <p>
          In the case of Event Affordances, the additional keywords <code>data</code>, <code>subscription</code> and
          <code>cancellation</code> are used to describe the payload when the event data is delivered by the Exposed
          Thing,
          the payload needed to subscribe to the event and the payload needed to cancel receiving event data from the
          Exposed Thing, respectively.
        </p>
        <p>
          In addition to the example pattern in [[WOT-THING-DESCRIPTION]] of an object with name/value
          constructs or simple arrays, Protocol Bindings for existing standards
          may require nested arrays and objects, and some constant values to
          be specified.
        </p>

        <p>
          Below are examples of different payloads and their corresponding <code>DataSchema</code>. 
        </p>
            
        <p>
          For example, a simple payload structure may use a map:
        </p>
        <table>
          <tbody>
          <tr>
            <td style="vertical-align: top; width: 50%"> 
              <pre class="example" title="Simple JSON Object Payload">
                {
                  "level": 50,
                  "time": 10
                }
              </pre> 
            </td>
            <td style="vertical-align: top; width: 50%"> 
              <pre class="example" title="DataSchema for Simple JSON Object Payload">
                {
                  "type": "object",
                  "properties": {
                    "level": {
                      "@type": ["iot:LevelData"],
                      "type": "integer",
                      "minimum": 0,
                      "maximum": 255
                    },
                    "time": {
                      "@type": ["iot:TransitionTimeData"],
                      "type": "integer",
                      "minimum": 0,
                      "maximum": 65535
                    }
                  }
                }
              </pre> 
            </td>
          </tr>
          </tbody>
        </table>


        <p>
          SenML [[RFC8428]] might use the following construct:
        </p>

        <table>
          <tbody>
            <tr>
              <td style="vertical-align: top; width: 50%">
                <pre class="example" title="SenML Example">
                  [
                    {
                      "bn": "/example/light/"
                    },
                    {
                      "n": "level",
                      "v": 50
                    },
                    {
                      "n": "time",
                      "v": 10
                    }
                  ]
                </pre>
              </td>
              <td style="vertical-align: top; width: 50%">
                <pre class="example" title="DataSchema for SenML Payload">
                  {
                    "type": "array",
                    "items": [
                      {
                        "type": "object",
                        "properties": {
                          "bn": {
                            "type": "string",
                            "const": "example/light"
                          }
                        }
                      },
                      {
                        "type": "object",
                        "properties": {
                          "n": {
                            "type": "string",
                            "const": "level"
                          },
                          "v": {
                            "@type": ["iot:LevelData"],
                            "type": "integer",
                            "minimum": 0,
                            "maximum": 255
                          }
                        }
                      },
                      {
                        "type": "object",
                        "properties": {
                          "n": {
                            "type": "string",
                            "const": "time"
                          },
                          "v": {
                            "@type": ["iot:TransitionTimeData"],
                            "type": "integer",
                            "minimum": 0,
                            "maximum": 65535
                          }
                        }
                      }
                    ]
                  }
                </pre>
              </td>
            </tr>
          </tbody>
        </table>

          <p>
            A Batch Collection according to OCF[[OCF]] may be structured like this:
          </p>

          <table>
            <tbody>
              <tr>
                <td style="vertical-align: top; width: 50%">
                  <pre class="example" title="OCF Batch Example">
                    [
                      {
                        "href": "/example/light/level",
                        "rep": {
                          "dimmingSetting": 50
                        }
                      },
                      {
                        "href": "/example/light/time",
                        "rep": {
                          "rampTime": 10
                        }
                      }
                    ]
                  </pre>
                </td>
                <td style="vertical-align: top; width: 50%">
                  <pre class="example" title="DataSchema for OCF Batch Payload">
                    {
                      "type": "array",
                      "items": [
                        {
                          "type": "object",
                          "properties": {
                            "href": {
                              "type": "string",
                              "const": "/example/light/level"
                            },
                            "rep": {
                              "type": "object",
                              "properties": {
                                "dimmingSetting": {
                                  "@type": ["iot:LevelData"],
                                  "type": "integer",
                                  "minimum": 0,
                                  "maximum": 255
                                }
                              }
                            }
                          }
                        },
                        {
                          "type": "object",
                          "properties": {
                            "href": {
                              "type": "string",
                              "const": "/example/light/time"
                            },
                            "rep": {
                              "type": "object",
                              "properties": {
                                "rampTime": {
                                  "@type": ["iot:TransitionTimeData"],
                                  "type":"integer",
                                  "minimum": 0,
                                  "maximum": 65535
                                }
                              }
                            }
                          }
                        }
                      ]
                    }
                  </pre>
                </td>
              </tr>
            </tbody>
          </table>



          <p>
            And an IPSO Smart Object on LWM2M [[LWM2M]] might look like the following:
          </p>

          <table>
            <tbody>
              <tr>
                <td style="vertical-align: top; width: 50%">
                  <pre class="example" title="IPSO/LWM2M Example">
                    {
                      "bn": "/3001/0/",
                      "e": [
                        {
                          "n": "5044",
                          "v": 0.5
                        },
                        {
                          "n": "5002",
                          "v": 10.0
                        }
                      ]
                    }
                  </pre>
                </td>
                <td style="vertical-align: top; width: 50%">
                  <pre class="example" title="DataSchema for IPSO/LWM2M Payload">
                    {
                      "type": "object",
                      "properties": {
                        "bn": {
                          "type": "string",
                          "const": "/3001/0/"
                        },
                        "e": {
                          "type": "array",
                          "items": [
                            {
                              "type": "object",
                              "properties": {
                                "n": {
                                  "type": "string",
                                  "const": "5044"
                                },
                                "v": {
                                  "@type": ["iot:LevelData"],
                                  "type": "number",
                                  "minimum": 0.0,
                                  "maximum": 1.0
                                }
                              }
                            },
                            {
                              "type": "object",
                              "Properties": {
                                "n": {
                                  "type": "string",
                                  "const": "5002"
                                },
                                "v": {
                                  "@type": ["iot:TransitionTimeData"],
                                  "type": "number",
                                  "minimum": 0.0,
                                  "maximum": 6553.5
                                }
                              }
                            }
                          ]
                        }
                      }
                    }
                  </pre>
                </td>
              </tr>
            </tbody>
          </table>
          
      </section>

      <section id="data-types-constraints">
        <h2>Data Types and value constraints</h2>
        <p>
          Note that in Example 7 above, the values are floating point (<code>double</code>) while the other examples have integer values.
          In general, Consumers should follow the data schemas strictly, not generating anything not given in the WoT Thing Description, but should accept additional data from the Thing not given explicitly in the WoT Thing Description.
          This means that a Consumer sending the payload of the Example 7 should use floating points in the payload.
        </p>
      </section>

      <section id="mapping-to-xml-schema">
        <h2>XML Schema Binding</h2>
        In the previous sections, the examples showed what data, whose value is described using the Data Schema, look like when serialized to JSON.

        This section describes how type definitions described using the Data Schema can be mapped to XML schema
        definitions by using the same examples. Given these Data Schemas, providing the mapping to XML schema allows
        XML tools to directly validate serialized XML data, for example. The XML structure for which this mapping is
        designed is based on EXI4JSON [exi-for-json].

        <section id="mapping-to-xml-schema-object">
          <h2>Object Definition to XML Schema</h2>

          Shown below is an example Data Schema of an Object Schema. The object consists of two named literals <code>id</code> (of type <code>integer</code>) and <code>name</code> (of
          type <code>string</code>) where <code>id</code> is required to be present.
          <pre class="example" title="JSON Schema description of the required JSON Object">
            {
              "type": "object",
              "properties": {
                  "id": {
                          "type": "integer"
                  },
                  "name": {
                          "type": "string"
                  }
              },
              "required": [
                  "id"
              ]
            }
          </pre>
          When the <code>object</code> is anonymous (i.e. it is the root, or participates in an <code>array</code>
          definition), the above <code>object</code> definition transforms to the following XML Schema element
          definition.

          <pre class="example" title="XML Schema mapping of the above JSON Schema with an anonymous object">
            <pre class="hljs xml" aria-busy="false"><span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"object"</span> <span class="hljs-attr">xmlns:xs</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">xs:complexType</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">xs:all</span>&gt;</span>
                      <span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"id"</span>&gt;</span>
                          <span class="hljs-tag">&lt;<span class="hljs-name">xs:complexType</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">xs:sequence</span>&gt;</span>
                              <span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"integer"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"xs:integer"</span> /&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">xs:sequence</span>&gt;</span>
                          <span class="hljs-tag">&lt;/<span class="hljs-name">xs:complexType</span>&gt;</span>
                      <span class="hljs-tag">&lt;/<span class="hljs-name">xs:element</span>&gt;</span>
                      <span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">minOccurs</span>=<span class="hljs-string">"0"</span>&gt;</span>
                          <span class="hljs-tag">&lt;<span class="hljs-name">xs:complexType</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">xs:sequence</span>&gt;</span>
                              <span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"xs:string"</span> /&gt;</span>
                            <span class="hljs-tag">&lt;/<span class="hljs-name">xs:sequence</span>&gt;</span>
                          <span class="hljs-tag">&lt;/<span class="hljs-name">xs:complexType</span>&gt;</span>
                      <span class="hljs-tag">&lt;/<span class="hljs-name">xs:element</span>&gt;</span>
                  <span class="hljs-tag">&lt;/<span class="hljs-name">xs:all</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">xs:complexType</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">xs:element</span>&gt;</span></pre>
          </pre>

          Otherwise (i.e. the <code>object</code> is a member of another <code>object</code> definition, thus has a
          name), the object definition transforms to the following XML schema element definition. Note
          <code>$name</code> represents the name of the <code>object</code>, and needs to be replaced by the actual name
          of the <code>object</code>.

          <pre class="example" title="XML Schema mapping of the above JSON Schema with a non-anonymous object">
            <pre class="hljs xml" aria-busy="false"><span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"$name"</span> <span class="hljs-attr">xmlns:xs</span>=<span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">xs:complexType</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class="hljs-name">xs:sequence</span>&gt;</span>
                  &lt!--Until the next comment, it is a copy of the previous example--&gt
                      <span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"object"</span>&gt;</span>
                          <span class="hljs-tag">&lt;<span class="hljs-name">xs:complexType</span>&gt;</span>
                              <span class="hljs-tag">&lt;<span class="hljs-name">xs:all</span>&gt;</span>
                                  <span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"id"</span>&gt;</span>
                                      <span class="hljs-tag">&lt;<span class="hljs-name">xs:complexType</span>&gt;</span>
                                        <span class="hljs-tag">&lt;<span class="hljs-name">xs:sequence</span>&gt;</span>
                                          <span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"integer"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"xs:integer"</span> /&gt;</span>
                                        <span class="hljs-tag">&lt;/<span class="hljs-name">xs:sequence</span>&gt;</span>
                                      <span class="hljs-tag">&lt;/<span class="hljs-name">xs:complexType</span>&gt;</span>
                                  <span class="hljs-tag">&lt;/<span class="hljs-name">xs:element</span>&gt;</span>
                                  <span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"name"</span> <span class="hljs-attr">minOccurs</span>=<span class="hljs-string">"0"</span>&gt;</span>
                                      <span class="hljs-tag">&lt;<span class="hljs-name">xs:complexType</span>&gt;</span>
                                        <span class="hljs-tag">&lt;<span class="hljs-name">xs:sequence</span>&gt;</span>
                                          <span class="hljs-tag">&lt;<span class="hljs-name">xs:element</span> <span class="hljs-attr">name</span>=<span class="hljs-string">"string"</span> <span class="hljs-attr">type</span>=<span class="hljs-string">"xs:string"</span> /&gt;</span>
                                        <span class="hljs-tag">&lt;/<span class="hljs-name">xs:sequence</span>&gt;</span>
                                      <span class="hljs-tag">&lt;/<span class="hljs-name">xs:complexType</span>&gt;</span>
                                  <span class="hljs-tag">&lt;/<span class="hljs-name">xs:element</span>&gt;</span>
                              <span class="hljs-tag">&lt;/<span class="hljs-name">xs:all</span>&gt;</span>
                          <span class="hljs-tag">&lt;/<span class="hljs-name">xs:complexType</span>&gt;</span>
                      <span class="hljs-tag">&lt;/<span class="hljs-name">xs:element</span>&gt;</span>
                  &lt!--Until here--&gt
                  <span class="hljs-tag">&lt;/<span class="hljs-name">xs:sequence</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">xs:complexType</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">xs:element</span>&gt;</span></pre>
          </pre>

        </section>

        <section id="mapping-to-xml-schema-array">
          <h2>Array Schema to XML Schema</h2>

          Shown below is an example Data Schema of an Array Schema. The <code>array</code> consists of exactly three number literals with each value within the value range of [ 0 ... 2047 ].

          <pre class="example" title="JSON Schema description of the required JSON Array">
            {
                "type": "array",
                "items": {
                    "type": "number",
                    "minimum": 0,
                    "maximum": 2047
                },
                "minItems": 3,
                "maxItems": 3
            }
          </pre>

          When the <code>array</code> is anonymous (i.e. it is the root, or participates in another <code>array</code>
          definition), the above <code>array</code> definition transforms to the following XML Schema element
          definition.

          <pre class="example" title="XML Schema mapping of the above JSON Schema with an anonymous array">
            <pre class="hljs xml" aria-busy="false"><span class=
              "hljs-tag">&lt;<span class=
              "hljs-name">xs:element</span> <span class=
              "hljs-attr">name</span>=<span class=
              "hljs-string">"array"</span> <span class=
              "hljs-attr">xmlns:xs</span>=<span class=
              "hljs-string">"http://www.w3.org/2001/XMLSchema"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:complexType</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:sequence</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:element</span> <span class=
  "hljs-attr">name</span>=<span class=
  "hljs-string">"double"</span> <span class=
  "hljs-attr">minOccurs</span>=<span class=
  "hljs-string">"3"</span> <span class=
  "hljs-attr">maxOccurs</span>=<span class=
  "hljs-string">"3"</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:simpleType</span> <span class=
  "hljs-attr">name</span>=<span class=
  "hljs-string">"minInclusive"</span>&gt;</span>
                      <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:restriction</span> <span class=
  "hljs-attr">base</span>=<span class=
  "hljs-string">"xs:double"</span>&gt;</span>
                          <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:minInclusive</span> <span class=
  "hljs-attr">value</span>=<span class=
  "hljs-string">"0"</span>/&gt;</span>
                          <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:maxInclusive</span> <span class=
  "hljs-attr">value</span>=<span class=
  "hljs-string">"2047"</span>/&gt;</span>
                      <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:restriction</span>&gt;</span>
                  <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:simpleType</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:element</span>&gt;</span>
          <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:sequence</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:complexType</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:element</span>&gt;</span></pre>
          </pre>

          Otherwise (i.e. the <code>array</code> is a member of an <code>object</code> definition, thus has a name), the
          <code>array</code> definition transforms to the following XML schema element definition.
          Note <code>$name</code> represents the name of the <code>array</code>, and needs to be replaced by the actual
          name of the <code>array</code>.

          <pre class="example" title="XML Schema mapping of the above JSON Schema with a non-anonymous array">
            <pre class="hljs xml" aria-busy="false"><span class=
              "hljs-tag">&lt;<span class=
              "hljs-name">xs:element</span> <span class=
              "hljs-attr">name</span>=<span class=
              "hljs-string">"$name"</span> <span class=
              "hljs-attr">xmlns:xs</span>=<span class=
              "hljs-string">"http://www.w3.org/2001/XMLSchema"</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:complexType</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:sequence</span>&gt;</span>
          &lt!--Until the next comment, it is a copy of the previous example--&gt
              <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:element</span> <span class=
  "hljs-attr">name</span>=<span class=
  "hljs-string">"array"</span>&gt;</span>
                  <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:complexType</span>&gt;</span>
                      <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:sequence</span>&gt;</span>
                          <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:element</span> <span class=
  "hljs-attr">name</span>=<span class=
  "hljs-string">"double"</span> <span class=
  "hljs-attr">minOccurs</span>=<span class=
  "hljs-string">"3"</span> <span class=
  "hljs-attr">maxOccurs</span>=<span class=
  "hljs-string">"3"</span> &gt;</span>
                              <span class="hljs-tag">&lt;<span class=
  "hljs-name">xs:simpleType</span> <span class=
  "hljs-attr">name</span>=<span class=
  "hljs-string">"minInclusive"</span>&gt;</span>
                                  <span class=
  "hljs-tag">&lt;<span class=
  "hljs-name">xs:restriction</span> <span class=
  "hljs-attr">base</span>=<span class=
  "hljs-string">"xs:double"</span>&gt;</span>
                                      <span class=
  "hljs-tag">&lt;<span class=
  "hljs-name">xs:minInclusive</span> <span class=
  "hljs-attr">value</span>=<span class=
  "hljs-string">"0"</span>/&gt;</span>
                                      <span class=
  "hljs-tag">&lt;<span class=
  "hljs-name">xs:maxInclusive</span> <span class=
  "hljs-attr">value</span>=<span class=
  "hljs-string">"2047"</span>/&gt;</span>
                                  <span class=
  "hljs-tag">&lt;/<span class=
  "hljs-name">xs:restriction</span>&gt;</span>
                              <span class=
  "hljs-tag">&lt;/<span class="hljs-name">xs:simpleType</span>&gt;</span>
                          <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:element</span>&gt;</span>
                      <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:sequence</span>&gt;</span>
                  <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:complexType</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:element</span>&gt;</span>
          &lt!--Until here--&gt
          <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:sequence</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:complexType</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class=
  "hljs-name">xs:element</span>&gt;</span></pre>
          </pre>

        </section>

      </section>

    </section>

    <section id="form-element">
      <h2>Forms Element</h2>
      <p>
        The form elements contain the URI [[RFC3986]] pointing to an instance of the interaction
        and descriptions of the protocol settings and options expected to be used when
        between the Consumer and the Thing for the interaction.
      </p>

      <section id="operation-types">
        <h2>Operation Types</h2>
        <p>
          Form Operation Types describe the intended semantics of performing the operation
          described by the form.
        </p>
        <p>
          For example, the Property interaction allows read and write operations. The
          protocol binding may contain a form for the read operation and a different
          form for the write operation. The value of the <code>op</code> attribute of the form
          indicates which form is which and allows the Consumer to select the correct
          form for the operation required.
        </p>

        <pre class="example" title="Form Operation Types">
            "op": "readproperty"
            "op": "writeproperty"
          </pre>

        <p>
          The vocabulary in section 4 lists the recommended set of form operations,
          and the full TD examples in section 5 contain example uses of form operations types.
        </p>
      </section>

      <section id="content-types">
        <h2>Content Types</h2>
        <p>
          Content Types define the serialization details and other rules for processing the payloads. 
          The content type is used to select a serializer/deserializer and to select an additional set of rules and constraints for the protocol driver. 
          Content type includes the media type and potential parameters for the media type.
        </p>
        
        <p>
          For example, the media type <code>application/ocf+cbor</code> indicates that CBOR
          serialization is used, but also that OCF rules and namespaces
          apply to the processing of the representations.
        </p>
        <p>
          Some special protocol drivers may be invoked by using a non-registered
          media type (e.g., <code>x-<echonet></code>) along with a custom URI Scheme [[RFC3986]] and its own
          set of protocol methods and options defined for that URI Scheme.
        </p>

        <p> When the media type is <code>application/xml</code> (or its binary representation
          <code>application/exi</code>) and
          there is a Data Schema provided for the payload, the payloads are constrained by a XML Schema derived from the
          Data Schema.
          See <a href="#mapping-to-xml-schema" class="sec-ref">ยง&nbsp;
            <bdi class="secno">
              3.1.3
            </bdi>XML Schema Binding
          </a> Schema Binding for how to derive a XML Schema from a Data Schema definition.
        </p>

        <p>Below are some examples of payloads in JSON and their corresponding equivalent payloads in XML.</p>

        <pre class="example"
          title="JSON Payload of Object type for specifying the desired brightness and flashing frequency of a lamp">
            {
              "brightness": 200,
              "frequency": "fast"
            }
          </pre>


        <pre class="example" title="Corresponding XML Payload for the previous JSON Payload">

<pre class="hljs xml" aria-busy="false"><span class="hljs-tag">&lt;<span class="hljs-name">object</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">brightness</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">integer</span>&gt;</span>200<span class="hljs-tag">&lt;/<span class="hljs-name">integer</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">brightness</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">frequency</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">string</span>&gt;</span>fast<span class="hljs-tag">&lt;/<span class="hljs-name">string</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">frequency</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">object</span>&gt;</span></pre>
        </pre>

        <pre class="example"
          title="JSON Payload of Array type for specifying the desired brightness and flashing frequency of a lamp">
[
  520,
  184,
  1314
]
          </pre>


        <pre class="example" title="Corresponding XML Payload for the previous JSON Payload">

<pre class="hljs xml" aria-busy="false"><span class="hljs-tag">&lt;<span class="hljs-name">array</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">number</span>&gt;</span>520<span class="hljs-tag">&lt;/<span class="hljs-name">number</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">number</span>&gt;</span>184<span class="hljs-tag">&lt;/<span class="hljs-name">number</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">number</span>&gt;</span>1314<span class="hljs-tag">&lt;/<span class="hljs-name">number</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">array</span>&gt;</span></pre>
        </pre>

      </section>

      <section id="protocol-methods-options">
        <h2>Protocol Methods and Options</h2>
        <p>
          Each target protocol may specify different method names for similar
          operations, and there may be semantic differences between similar method names of
          different protocols. Additionally, platforms may use different methods
          for realizing a particular WoT Interaction Affordance. For example, POST may
          be used for writing a Property value in one platform, while PUT may be
          used in another. For these reasons, we require the ability to specify
          which method to use for a particular Interaction. We also will provide
          vocabulary to differentiate between methods of different protocols.
        </p>
        <p>
          The W3C RDF vocabulary for HTTP [[HTTP-in-RDF10]] is used to identify the methods
          and options specified in the HTTP protocol bindings.
        </p>
        <p>
          For the sake of consistency, we will use the same ontology design pattern
          to derive a vocabulary for each target protocol, e.g. CoAP, MQTT.
        </p>

        <p>
          The example below shows some method definitions for various protocols.
        </p>

        <pre class="example" title="Vocabulary Example for Methods">
            "htv:methodName": "GET"

            "mqv:controlPacketValue": "SUBSCRIBE"

            "cov:methodName": "GET"
          </pre>

        <p>
          Header options in HTTP, CoAP, MQTT sometimes must be included in a
          protocol binding in order to successfully interact with the underlying
          protocol. The example below shows the structure of the definition for
          HTTP header options, according to the W3C HTTP Vocabulary in RDF.
        </p>

        <pre class="example" title="HTTP Vocabulary Example for Header Options">
            "htv:headers":
              [
                {
                  "htv:fieldName": "Accept",
                  "htv:fieldValue": "application/json"
                },
                {
                  "htv:fieldName": "Transfer-Encoding",
                  "htv:fieldValue": "chunked"
                }
              ]
          </pre>
        <p>
          Note: different forms in a binding may need different header constructions,
          therefore the <code>htv:headers</code> construct is an extension of the TD "form" element.
        </p>
        <p>
          Protocols may have defined sub-protocols that can be used for some interaction
          types. For example, to receive asynchronous notifications using HTTP, some
          servers may support long polling (<code>longpoll</code>), WebSub [[WebSub]] (<code>websub</code>)
          and Server-Sent Events [[eventsource]] (<code>sse</code>).

          The <code>subprotocol</code> item may be defined in a form instance to indicate the
          use of one of these protocols, for example long polling with its special use of HTTP:
          <pre class="example" title="subprotocol">
              {
                "op": "subscribeevent",
                "href": "https://mylamp.example.com/overheating",
                "subprotocol": "longpoll"
              }
            </pre>
          </thead>

        </p>
      </section>

      <section id="uri-variables">
        <h2>URI Template Variables</h2>
        <p>
          When Interaction Affordances require dynamic variables in the <code>href</code>,
          they can be described using <code>uriVariables</code> in the Data Schema of the interaction.
          For example, <code>p</code> and <code>d</code> in <code>http://192.168.1.25/left?p=2&d=1</code>
          can be described with a template as defined in [[RFC6570]]
          ]: <code>http://192.168.1.25/left{?p,d}</code>.
        </p>

        <p>
          In such a case, the URI Template variables <i>MUST</i> be collected in the JSON-object based
          <code>uriVariables</code>
          member with the associated (unique) variable names as JSON names.
        </p>

        <p>
          The serialization of each value in the map assigned to <code>uriVariables</code> in an instance of
          <code>Form</code> <i>MUST</i> rely on
          the DataSchema as explained in <a href="#sec-data-schema" class="sec-ref">ยง&nbsp;
            <bdi class="secno">
              3.1
            </bdi>Data Schema</a>.
        </p>

        <p>
          An action affordance snippet using a URI Template and <code>uriVariables</code> is given below:
        </p>
        <pre class="example" title="Action Affordance using URI Template Variables">
                ...
                "actions": {
                    "LeftDown": {
                        ...
                        "uriVariables": {
                            "p" : { "type": "integer", "minimum": 0, "maximum": 16 },
                            "d" : { "type": "integer", "minimum": 0, "maximum": 1 }
                        },
                        "forms": [{
                          "href" : "http://192.168.1.25/left{?p,d}",
                          "htv:methodName": "GET"
                        }]
                    },
                    ...
                },
                ...
              </pre>

      </section>

    </section>


    <section id="sec-interaction-patterns" class="informative">
      <h1>Interaction Affordances</h1>
      <p>
        This section describes unique aspects of protocol bindings for the three
        WoT Interaction Affordances.
      </p>

      <section id="property-bindings">
        <h2>Bindings for Properties</h2>
        <p>
          This section describes unique aspects of protocol bindings for
          WoT Property interactions.
        </p>
        <p>

          The abstract operations exposed for the Property Interaction are <code>readproperty</code>,
          <code>writeproperty</code>, <code>observeproperty</code> and <code>unobserveproperty</code>.
          These are mapped by using form operations that describe how
          the abstract operation is performed, resulting in a semantic interpretation similar to
          HTML form submission.
        </p>

        <p>
          Additionally, the abstract operations exposed for multiple Property Interactions are
          <code>readallproperties</code>,
          <code>writeallproperties</code>, <code>readmultipleproperties</code> and <code>writemultipleproperties</code>.
        </p>

        <pre class="example" title="Example use of form operation for Property">
          {
            "op": "writeproperty",
            "href": "/example/level",
            "htv:methodName": "POST"
          }
        </pre>

        <p>
          The form element in the example above conveys the statement: <i>"To do a <code>writeproperty</code> of the
            subject Property (context of the form),
            perform an <code> HTTP POST</code> on the resource at the target URI <code>/example/level</code>."</i>
        </p>
        <p>
          Properties may be observable, defined by the TD keyword "observable".
          If there is an observe form and a retrieve form, the observe form may be
          indicated by including <code>op=observeproperty</code> in the form. The observe form may
          also specify header options to use, as specified in Observing in CoAP[[?RFC7641]]for example setting the CoAP Observe option to <code>0</code> in the header, starts observation.
        </p>
      </section>

      <section id="action-bindings" class="informative">
        <h2>Bindings for Actions</h2>
        <p>
          This section describes unique aspects of protocol bindings for Actions.
        </p>
        <p>

          The abstract operation on Actions is <code>invokeaction</code>.
          In the same way that the abstract operations on Properties are mapped using form operation types,
          the abstract operation of Actions is also mapped.
        </p>
        <pre class="example" title="Example use of form operation for Action">
          {
            "op": "invokeaction",
            "href": "/example/levelaction",
            "http:methodName": "POST"
          }

        </pre>
        <p>
          The form element in the example above conveys the statement: <i>"To do an <code>invokeaction</code> of the subject Action (context of the form), perform a <code>POST</code> on the resource at the target URI <code>/example/levelaction</code>."</i>
        </p>
      </section>

      <section id="event-bindings" class="informative">
        <h2>Bindings for Events</h2>
        <p>
          This section describes unique aspects of protocol bindings for WoT
          Event Interaction Affordances.
        </p>
        <p>

          The abstract operations on Events are <code>subscribeevent</code> and <code>unsubscribeevent</code>.
          The <code>subscribeevent</code> operation may directly enable event instance delivery
          from the pre-defined URI to observable resources or pubsub topics encoded in URIs.
          Alternatively, it may return a location or resource URI from which event instance may be obtained,
          either by observation or some other mechanism, depending on the transfer protocol.
        </p>
        <p>
          Usually, the <code>unsubscribeevent</code> only occurs when the transfer protocol has no implicit
          unsubscribe operation such as closing the connection. Examples are Webhooks that require particular
          unsubscribe requests.

        </p>
        <p>
          If the binding offers an observable Event resource from which events are
          obtained, there will be a form which describes the required transfer layer
          operation, for example CoAP Observe or HTTP Long Polling.
        </p>

        <pre class="example" title="Example use of form operation for Events">
          {
            "op": "subscribeevent",
            "href": "mqtt://wot.example.com/levelevent",
            "mqv:controlPacketValue": "SUBSCRIBE"
          }

        </pre>
        <p>
          The form element in the example above conveys the statement: <i>"To do an <code>subscribeevent</code> of the subject Event (context of the form), perform an <code>MQTT SUBSCRIBE</code> on the topic <code>/levelevent</code> on the broker at <code>wot.example.com</code> using the default MQTT port."</i>
        </p>
      </section>

    </section>
<!-- 
    <section id="processing-model" class="informative">
      <h1>Processing Model and Runtime</h1>
      <p>
        This section describes the processing model for Protocol Bindings with
        respect to the abstract WoT operations provided by the Scripting API.
      </p>
      <p>
        <code>DataSchema</code> elements (see <a href="#sec-data-schema" class="sec-ref">ยง&nbsp;
          <bdi class="secno">
            3.1
          </bdi>Data Schema</a> ) are processed, and
        value scaling is performed, in the application library or adaptation layer.
      </p>
      <p>
        Form elements that specify href, method, options, and contentType are
        processed in a driver context which is isolated from the application.
      </p>
      <p>
        The application, or a protocol adaptation layer, constructs an instance of
        the appropriate DataSchema element
        and sends it along with the selected form contents to the protocol driver
        or, in the case of get, receives a payload form the protocol driver and
        uses the appropriate <code>DataSchema</code> element to extract the field values of interest.
      </p>
      <p>
        The separation of execution context between the application and the protocol
        driver enables isolation of fault domains and isolation of security domains.
      </p>
      <p>
        Protocol Bindings may be used by proxies, where a Consumed Thing has its
        Protocol Binding, and the corresponding Exposed Thing may have a different
        Protocol Binding.
      </p>
    </section> -->

  </section>

  <section id="vocabulary" class="normative">
    <h1>Vocabulary</h1>
    <p>
      This section summarizes the vocabulary used for Binding Templates.
      The vocabulary is defined in other documents, in particular the WoT Thing Description [[!WOT-THING-DESCRIPTION]]
    </p>
    <section>
      <h2><code>DataSchema</code> Vocabulary</h2>
      <p>
        <code>DataSchema</code> elements describe the structure of the payload.
        The <code>DataSchema</code> class and vocabulary is defined in [[!WOT-THING-DESCRIPTION]].
        Properties and Events directly implement the <code>DataSchema</code> class
        (i.e., they contain the corresponding fields such as <code>type</code>),
        which describes the data transfer in either direction.
        Actions may define an <code>input</code> data schema for actuation data being sent to the Action
        and/or an <code>output</code> data schema for result or status data being returned from
        the Action.

      </p>
    </section>

    <section>
      <h2>Form Operation Type Vocabulary</h2>
      <p>

        Each interaction affordance has associated form operation types (i.e. <code>op</code>)
        that are used to select the form element corresponding to the intended interaction from the Array of forms.
        For example, for one interaction, a Consumer can choose the form element corresponding to reading a Property, 
        observing a Property or writing to Property by using the form operation type.

      </p>
      <section>
        <h3>Property Forms</h3>
        <p>
          Properties can provide <code>readproperty</code> and <code>writeproperty</code>
          operations, which map to GET and PUT/POST of a REST API, respectively.
          Properties may also by observed if they provide an <code>observeproperty</code> operation and 
          the observation can be stopped if the property provides an <code>unobserveproperty</code> operation.
        </p>
        <table class="def">
          <thead>
            <tr>
              <th><code>op</code> Term</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>readproperty</code></td>
              <td>Read a Property. Requires <code>writeOnly</code> to be set to <code>false</code>.</td>
            </tr>
            <tr>
              <td><code>writeproperty</code></td>
              <td>Write a Property. Requires <code>readOnly</code> to be set to <code>false</code>.</td>
            </tr>
            <tr>
              <td><code>observeproperty</code></td>
              <td>Observe a Property. Requires <code>observable</code> to be set to <code>true</code>.</td>
            </tr>
            <tr>
              <td><code>unobserveproperty</code></td>
              <td>Unobserve a Property. Requires <code>observable</code> to be set to <code>true</code>.</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h3>Action Forms</h3>
        <p>
          Actions only provide <code>invokeaction</code> operations.
          For completeness, there is also a form operation type defined.
        </p>
        <table class="def">
          <thead>
            <tr>
              <th><code>op</code> Term</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>invokeaction</code></td>
              <td>Invoke an Action.</td>
            </tr>
          </tbody>
        </table>
      </section>

      <section>
        <h3>Event Forms</h3>
        <p>
          Events describe subscription endpoints from which to event instances can be received 
          and unsubscription endpoints to stop receiving event instances.
        </p>
        <table class="def">
          <thead>
            <tr>
              <th><code>op</code> Term</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>subscribeevent</code></td>
              <td>Subscribe to an Event.</td>
            </tr>
            <tr>
              <td><code>unsubscribeevent</code></td>
              <td>Unsubscribe from an Event.</td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>

    <section>
      <h2>Protocol Vocabulary</h2>
      <p>
        Extensions to the Thing Description core vocabulary can inform the Consumer about
        protocol-specific message configurations such as methods, options, and status codes.
        By using such information, the Consumer can build the protocol specific request that allows interaction with the Exposed Thing.
        Per default the Thing Description includes HTTP Vocabulary by including the HTTP RDF vocabulary definitions from HTTP Vocabulary in RDF 1.0 [HTTP-in-RDF10].
      </p>
      <p class="ednote" title="Protocol Vocabulary Definitions">
        The WoT Working Group is investigating good ways to also provide COAP and MQTT Vocabulary in RDF.
        Whether the WG will publish corresponding WG Notes is still subject to discussion.
      </p>

    <p>
      The protocol vocabularies for each protocol are presented as two tables per protocol.
      The first table details the vocabulary terms, whereas the second one lists a default mapping of the <code>op</code> for the given protocol, if that <code>op</code> value is defined for the given protocol.
    </p>
    <p>   
      Other protocols can be easily integrated into a Thing Description. 
      To do so, the vocabulary of the protocol should be linked via <code>@context</code> context extension, in which the different vocabulary terms used for the protocol should be described.
      A URI Scheme of the protocol is also necessary to identify it in the <code>href</code> value.
      A Consumer should be able to construct the appropriate requests based vocabulary terms defined in the Thing Description and should not rely on out-of-band information.
    </p>
      <section>

        <h3>HTTP Vocabulary</h3>
        <section>
        <h4>HTTP Vocabulary Terms</h4>
        <table class="def">
          <thead>
            <tr>
              <th>Vocabulary term</th>
              <th>Description</th>
              <th>Assignment</th>
              <th>Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>htv:methodName</code></td>
              <td>HTTP method name (Literal).</td>
              <td>optional</td>
              <td>
                <a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#string"><code>string</code></a>
                <p>(one of <code>"GET"</code>, <code>"PUT"</code>, <code>"POST"</code>, <code>"DELETE"</code>,
                  <code>"PATCH"</code>)</p>
              </td>
            </tr>
            <tr>
              <td><code>htv:headers</code></td>
              <td>HTTP headers sent with the message.</td>
              <td>optional</td>
              <td>
                array of <a
                  href="https://www.w3.org/TR/HTTP-in-RDF10/#MessageHeaderClass"><code>htv:MessageHeader</code></a>
              </td>
            </tr>
            <tr>
              <td><code>htv:fieldName</code></td>
              <td>Header name (Literal), e.g., <code>"Accept"</code>, <code>"Transfer-Encoding"</code>.</td>
              <td>mandatory within <code>htv:MessageHeader</code></td>
              <td>
                <a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#string"><code>string</code></a>
              </td>
            </tr>
            <tr>
              <td><code>htv:fieldValue</code></td>
              <td>Header value (Literal).</td>
              <td>mandatory within <code>htv:MessageHeader</code></td>
              <td>
                <a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#string"><code>string</code></a>
              </td>
            </tr>
          </tbody>
        </table>
      </section>
      <section>
        <h4>HTTP Default Vocabulary Terms</h4>
        <table class="def">
          <thead>
            <tr>
              <th><code>op</code> value</th>
              <th>Default Binding</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>readproperty</code></td>
              <td><code>"htv:methodName": "GET"</code></td>
            </tr>
            <tr>
              <td><code>writeproperty</code></td>
              <td><code>"htv:methodName": "PUT"</code></td>
            </tr>
            <!-- <tr>
              <td><code>observeproperty</code></td>
              <td> <code>
                "htv:methodName": "GET", <br>
                "subprotocol":"longpoll"
              </code>
              </td>
            </tr>
            <tr>
              <td><code>unobserveproperty</code></td>
              <td> Cancel pending HTTP GET request</td>
            </tr> -->
            <tr>
              <td><code>invokeaction</code></td>
              <td> <code>"htv:methodName": "POST" </code></td>
            </tr>
            <!-- <tr>
              <td><code>subscribeevent</code></td>
              <td> <code>
                  "htv:methodName": "GET", <br>
                  "subprotocol":"longpoll"
                </code>
            </tr>
            <tr>
              <td><code>unsubscribeevent</code></td>
              <td> Cancel pending HTTP GET request</td>
            </tr>
          -->
            <tr>
              <td><code>readallproperties</code></td>
              <td> <code>"htv:methodName": "GET"</code></td>
            </tr>
            <tr>
              <td><code>writeallproperties</code></td>
              <td> <code>"htv:methodName": "PUT"</code></td>
            </tr>
            <tr>
              <td><code>readmultipleproperties</code></td>
              <td> <code>"htv:methodName": "GET"</code></td>
            </tr>
            <tr>
              <td><code>writemultipleproperties</code></td>
              <td> <code>"htv:methodName": "PUT"</code></td>
            </tr>
          </tbody>
        </table>
      </section>
    </section>

      <section>
        <h3>CoAP Vocabulary</h3>

        <section>
        <h4>CoAP Vocabulary Terms</h4>
        <table class="def">
          <thead>
            <tr>
              <th>Vocabulary term</th>
              <th>Description</th>
              <th>Assignment</th>
              <th>Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>cov:methodName</code></td>
              <td>CoAP method name (Literal).</td>
              <td>optional</td>
              <td>
                <a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#string"><code>string</code></a>
                <p>(one of <code>"GET"</code> (1), <code>"POST"</code> (2), <code>"PUT"</code> (3), <code>"DELETE"</code> (4),
                  <code>"FETCH"</code> (5), <code>"PATCH"</code> (6), <code>"iPATCH"</code> (7))</p>
              </td>
            </tr>
            <tr>
              <td><code>cov:options</code></td>
              <td>CoAP options sent with the message, e.g., <code>[ { "cov:optionName": "Accept", "cov:optionValue": 110 }]</code> to observe.</td>
              <td>optional</td>
              <td>
                array of <code>cov:MessageOption</code>
              </td>
            </tr>
            <tr>
              <td><code>cov:optionName</code></td>
              <td>Option name (Literal), see <a
                  href="https://www.iana.org/assignments/core-parameters/core-parameters.xhtml#option-names">CoRE
                  Parameters</a>.</td>
              <td>mandatory within <code>cov:MessageOption</code></td>
              <td>
                <a href="http://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#string"><code>string</code></a>
              </td>
            </tr>
            <tr>
              <td><code>cov:optionValue</code></td>
              <td>Header value (Literal).</td>
              <td>mandatory within <code>cov:MessageOption</code></td>
              <td>
                <a href="https://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#anyType"><code>anyType</code></a>
              </td>
            </tr>
          </tbody>
        </table>
      </section>
      <section>
        <h4>CoAP Default Vocabulary Terms</h4>
        <table class="def">
          <thead>
            <tr>
              <th><code>op</code> value</th>
              <th>Default Binding</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>readproperty</code></td>
              <td><code>"cov:methodName": "GET"</code></td>
            </tr>
            <tr>
              <td><code>writeproperty</code></td>
              <td><code>"cov:methodName": "PUT"</code></td>
            </tr>
            <tr>
              <td><code>observeproperty</code></td>
              <td><code>"cov:methodName": "GET"</code>,<code>"subprotocol":"cov:observe"</code></td>
            </tr>
            <tr>
              <td><code>unobserveproperty</code></td>
              <td><code>"cov:methodName": "GET"</code>,<code>"subprotocol":"cov:observe"</code></td>
            </tr>
            <tr>
              <td><code>invokeaction</code></td>
              <td><code>"cov:methodName": "POST"</code></td>
            </tr>
            <tr>
              <td><code>subscribeevent</code></td>
              <td><code>"cov:methodName": "GET"</code>,<code>"subprotocol":"cov:observe"</code></td>
            </tr>
            <tr>
              <td><code>unsubscribeevent</code></td>
              <td><code>"cov:methodName": "GET"</code>,<code>"subprotocol":"cov:observe"</code></td>

            </tr>
            <tr>
              <td><code>readallproperties</code></td>
              <td> <code>"cov:methodName": "GET"</code></td>
            </tr>
            <tr>
              <td><code>writeallproperties</code></td>
              <td> <code>"cov:methodName": "PUT"</code></td>
            </tr>
            <tr>
              <td><code>readmultipleproperties</code></td>
              <td> <code>"cov:methodName": "GET"</code></td>
            </tr>
            <tr>
              <td><code>writemultipleproperties</code></td>
              <td> <code>"cov:methodName": "PUT"</code></td>
            </tr>
          </tbody>
        </table>
        </section>

        Observing Resources in CoAP should be done as specified in [[!RFC7641]].
        Since observing and unobserving need to be indicated with the Observe flag in the header, this mechanism can be also described in the <code> cov:options </code> with the value <code>[ { "cov:optionName": "Observe", "cov:optionValue": 0 }]</code>. 
        However, this is not enough to describe the mechanism of getting asynchronous updates from the observed resource.
        Thus, <code>"subprotocol":"cov:observe"</code> is used to indicate the observation mechanism.

        <p class="ednote">
          As indicated by the <a href="#coap-default-vocabulary-terms" class="sec-ref">CoAP Default Vocabulary Terms</a>, it is recommended to use the <code>subprotocol</code> to describe the observation. Thus, <code> cov:options </code> with the value <code>[ { "cov:optionName": "Observe", "cov:optionValue": 0 }]</code> MUST NOT be used together with <code>"subprotocol":"cov:observe"</code>, since it can lead to confusion.
        </p>

      </section>

      <section>

        <h3>MQTT Vocabulary</h3>
      

      <section>
        <h4>MQTT Vocabulary Terms</h4>

        <table class="def">
          <thead>
            <tr>
              <th>Vocabulary term</th>
              <th>Description</th>
              <th>Assignment</th>
              <th>Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>mqv:controlPacketValue</code></td>
              <td>MQTT Control Packet type (Literal).</td>
              <td>optional</td>
              <td>
                <a href="https://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#string"><code>string</code></a>
                <p>(one of <code>"PUBLISH"</code> (3), <code>"SUBSCRIBE"</code> (8), <code>"UNSUBSCRIBE"</code> (10))</p>
              </td>
            </tr>
            <tr>
              <td><code>mqv:options</code></td>
              <td>MQTT options sent with the message, e.g., <code>[ { "mqv:optionName": "qos", "mqv:optionValue": 1 }]</code>.</td>
              <td>optional</td>
              <td>
                array of <code>mqv:MessageOption</code></a>
              </td>
            </tr>
            <tr>
              <td><code>mqv:optionName</code></td>
              <td>Option name (Literal).</td>
              <td>mandatory within <code>mqv:MessageOption</code>)</td>
              <td>
                <a href="https://www.w3.org/TR/2012/REC-xmlschema11-2-20120405/#string"><code>string</code></a>
                <p>(one of <code>"qos"</code>, <code>"retain"</code>, <code>"dup"</code>)</p>
              </td>
            </tr>
            <tr>
              <td><code>mqv:optionValue</code></td>
              <td>Header value (Literal).</td>
              <td>mandatory within <code>mqv:MessageOption</code>)</td>
              <td>
               One of <code>0</code>, <code>1</code> or <code>2</code> (only for <code>qos</code>)
              </td>
            </tr>
          </tbody>
        </table>
        </section>

        <section>

        <h4>MQTT Default Vocabulary Terms</h4>
        <table class="def">
          <thead>
            <tr>
              <th><code>op</code> value</th>
              <th>Default Binding</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><code>readproperty</code></td>
              <td><code>"mqv:controlPacketValue": "SUBSCRIBE"</code></td>
            </tr>
            <tr>
              <td><code>writeproperty</code></td>
              <td> <code>"mqv:controlPacketValue": "PUBLISH"</code></td>
            </tr>
            <tr>
              <td><code>observeproperty</code></td>
              <td> <code>"mqv:controlPacketValue": "SUBSCRIBE"</code> </td>
            </tr>
            <tr>
              <td><code>unobserveproperty</code></td>
              <td> <code>"mqv:controlPacketValue": "UNSUBSCRIBE"</code></td>
            </tr>
            <tr>
              <td><code>invokeaction</code></td>
              <td><code> "mqv:controlPacketValue": "PUBLISH"</code></td>
            </tr>
            <tr>
              <td><code>subscribeevent</code></td>
              <td> <code>"mqv:controlPacketValue": "SUBSCRIBE"</code> </td>
            </tr>
            <tr>
              <td><code>unsubscribeevent</code></td>
              <td> <code>"mqv:controlPacketValue": "UNSUBSCRIBE"</code></td>
            </tr>
            <tr>
              <td><code>readallproperties</code></td>
              <td> <code>"mqv:controlPacketValue": "SUBSCRIBE"</code> </td>
            </tr>
            <tr>
              <td><code>writeallproperties</code></td>
              <td> <code>"mqv:controlPacketValue": "PUBLISH"</code></td>
            </tr>
            <tr>
              <td><code>readmultipleproperties</code></td>
              <td> <code>"mqv:controlPacketValue": "SUBSCRIBE"</code> </td>
            </tr> 
            <tr>
              <td><code>writemultipleproperties</code></td>
              <td> <code>"mqv:controlPacketValue": "PUBLISH"</code></td>
            </tr>
          </tbody>
        </table>
        For the MQTT protocol, if an MQTT client publishes a message to a topic with the retain flag set to true, the future subscribers of the topic will also get this message.
        Outside of this case, it is not possible to read a property but only possible to observe it. 
        <span class="rfc2119-assertion" id="iana-security-alter">Additionally, in a Form element with MQTT protocol, if the <code>op</code> contains <code>readproperty</code> (meaning that retain flag is set to true), it <em class="rfc2119" title="SHOULD">SHOULD</em> also contain <code>observeproperty</code>.</span>
        <span class="rfc2119-assertion" id="iana-security-alter">On the other hand, if the MQTT publisher does not set
          the retain flag to true, the property will be only observable. In this case, the property in the exposed Thing
          Description <em class="rfc2119" title="SHOULD NOT">SHOULD NOT</em> have Form elements with MQTT protocol containing <code>readproperty</code> operation.</span>
         </section>
      </section>
      <section id="modbus">
        <h3><a href="./bindings/modbus/index.html">MODBUS Vocabulary</a></h3>
      </section>
      <section>

        <h3><code>subprotocol</code> Vocabulary</h3>
        <p>
          The <code>subprotocol</code> field is defined in [[!WOT-THING-DESCRIPTION]].
        </p>
        <p>
          Currently, the supported values are <code>longpoll</code>, <code>websub</code> and <code>sse</code> defined for HTTP.
          Subprotocols can be used for asynchronous event delivery or observing Properties.
        </p>
        <p>
          For WebSockets, the IANA-registered Websocket Subprotocols [[iana-web-socket-registry]] may be used.
        </p>
        <p>
          For CoAP, <code>"subprotocol":"cov:observe"</code> can be used to describe asynchronous observation operations as defined by [[RFC6741]]
        </p>
      </section>

    </section>

  </section>

  <section id="binding-examples" class="informative">
    <h1>Examples of Thing Descriptions including protocol bindings</h1>

    <p>
      The following TD examples uses a fictional CoAP and MQTT Protocol Bindings, as no such Protocol Binding is available at the time of writing this specification.
      These <a>TD Context Extensions</a> assume that there is a CoAP and MQTT in RDF vocabulary similar to
      [[?HTTP-in-RDF10]] that is accessible via the namespace <code>http://www.example.org/coap-binding#</code> and
      <code>http://www.example.org/mqtt-binding#</code>, respectively.
      The supplemented <code>cov:methodName</code> member instructs the Consumer which CoAP method has to be applied
      (e.g., <code>GET</code> for the CoAP Method Code 0.01, <code>POST</code> for the CoAP Method Code 0.02, or
      <code>iPATCH</code> for CoAP Method Code 0.07).
      The supplemented <code>"mqv:controlPacketValue"</code> member instructs the Consumer which MQTT command has to be applied (e.g.,
      <code>8</code> for the subscribing and <code>10</code> for unsubscribing).
    </p>

    <p>
      A TD with simple payload format and protocols can be seen below. 
      Here each interaction affordance has one form with one protocol.
    </p>
    <pre class="example" title="TD with a Simple Payload">
        {
          "@context": [
            "https://www.w3.org/2019/wot/td/v1",
            {
              "iot": "http://iotschema.org/",
              "cov": "http://www.example.org/coap-binding#",
              "mqv": "http://www.example.org/mqtt-binding#"
            }
          ],
          "@type": [ "Thing", "iot:Light", "iot:LevelCapability", "iot:BinarySwitchCapability" ],
          "base": "http://example.com",
          "title": "Lamp",
          "id": "urn:dev:ops:32473-WoTLamp-1234",
          "securityDefinitions": {"basic_sc": {
            "scheme": "basic",
            "in": "header"
          }},
          "security": ["basic_sc"],
          "properties": {
            "switchState": {
              "@type": ["iot:SwitchStatus", "iot:SwitchData"],
              "type": "boolean",
              "writeOnly": false,
              "readOnly": false,
              "observable": false,
              "forms": [
                {
                  "href": "/example/light/currentswitch",
                  "op": ["readproperty", "writeproperty"],
                  "contentType": "application/json"
                }
              ]
            },
            "brightness": {
              "@type": ["iot:CurrentLevel", "iot:LevelData"],
              "type": "number",
              "writeOnly": false,
              "readOnly": false,
              "observable": false,
              "forms": [
                {
                  "href": "coap://example.com/example/light/currentdimmer",
                  "op": ["readproperty", "writeproperty"],
                  "contentType": "application/json"
                }
              ]
            }
          },
          "actions": {
            "switchOn": {
              "@type": ["iot:SwitchOnAction"],
              "input":  {
                "type": "boolean",
                "const": true
              },
              "forms": [
                {
                  "href": "/example/light/currentswitch",
                  "op": ["invokeaction"],
                  "contentType": "application/json"
                }
              ]
            },
            "switchOff": {
              "@type": ["iot:SwitchOff"],
              "input":  {
                "type": "boolean",
                "const": false
              },
              "forms": [
                {
                  "href": "/example/light/currentswitch",
                  "op": ["invokeaction"],
                  "contentType": "application/json"
                }
              ]
            },
            "setBrightness": {
              "@type": ["iot:SetLevelAction"],
              "input":  {
                "@type": ["iot:LevelData"],
                "type": "number"
              },
              "forms": [
                {
                  "href": "/example/light/currentdimmer",
                  "op": ["invokeaction"],
                  "contentType": "application/json"
                }
              ]
            }
          }
        }
      </pre>
    <p>
      Another version of the previous TD with complex payload and multiple protocol options is shown below. 
      Notably, the <code>brightness</code> property can be read via HTTP, written to via CoAP and observed via MQTT.
    </p>
    <pre class="example" title="TD with protocol options and complex payload">
      {
        "@context": [
          "https://www.w3.org/2019/wot/td/v1",
          {
            "iot": "http://iotschema.org/",
            "cov": "http://www.example.org/coap-binding#",
            "mqv": "http://www.example.org/mqtt-binding#"
          }
        ],
        "base": "http://example.com/",
        "@type": [ "Thing", "iot:Light", "iot:LevelCapability", "iot:BinarySwitch" ],
        "title": "Lamp",
        "id": "urn:dev:ops:32473-WoTLamp-1234",
        "securityDefinitions": {"basic_sc": {
          "scheme": "basic",
          "in": "header"
        }},
        "security": ["basic_sc"],
        "properties": {
          "switchState": {
            "@type": ["iot:SwitchStatus"],
            "type": "object",
            "properties": {
              "switch": {
                "@type": ["iot:SwitchData"],
                "type": "boolean"
              }
            },
            "writeOnly": false,
            "readOnly": false,
            "observable": true,
            "forms": [
              {
                "href": "/example/light/currentswitch",
                "contentType": "application/json",
                "op": ["readproperty"],
                "htv:methodName": "GET"
              },
              {
                "href": "/example/light/currentswitch",
                "contentType": "application/json",
                "op": ["writeproperty"],
                "htv:methodName": "POST"
              },
              {
                "href": "mqtt://example.com/example/light/currentswitch",
                "op": ["observeproperty"],
                "mqv:controlPacketValue": "SUBSCRIBE"
              }
            ]
          },
          "brightness": {
            "@type": ["iot:CurrentLevel"],
            "type": "object",
            "properties": {
              "brightness": {
                "@type": ["iot:LevelData" ],
                "type": "integer",
                "minimum": 0,
                "maximum": 255
              }
            },
            "writeOnly": false,
            "readOnly": false,
            "observable": true,
            "forms": [
              {
                "href": "coap://example.com/example/light/currentdimmer",
                "contentType": "application/json",
                "op": ["readproperty"],
                "cov:methodName": "GET"
              },
              {
                "href": "/example/light/currentdimmer",
                "contentType": "application/json",
                "op": ["writeproperty"],
                "htv:methodName": "POST"
              },
              {
                "href": "mqtt://example.com/example/light/currentdimmer",
                "op": ["observeproperty"],
                "mqv:controlPacketValue": "SUBSCRIBE"
              }
            ]
          },
          "transitionTime": {
            "@type": ["iot:TransitionTime"],
            "type": "object",
            "properties": {
              "transitionTime": {
                "@type": ["iot:TransitionTimeData" ],
                "type": "integer",
                "minimum": 0,
                "maximum": 255
              }
            },
            "writeOnly": false,
            "readOnly": false,
            "observable": false,
            "forms": [
              {
                "href": "/example/light/transitiontime",
                "contentType": "application/json",
                "op": ["readproperty"],
                "htv:methodName": "GET"
              },
              {
                "href": "/example/light/transitiontime",
                "contentType": "application/json",
                "op": ["writeproperty"],
                "htv:methodName": "POST"
              }
            ]
          }
        },
        "actions": {
          "switchOn": {
            "@type": ["iot:SwitchOnAction"],
            "input":  {
              "type": "boolean",
              "const": true
            },
            "forms": [
              {
                "href": "/example/light/currentswitch",
                "contentType": "application/json",
                "op": ["invokeaction"],
                "htv:methodName": "POST"
              }
            ]
          },
          "switchOff": {
            "@type": ["iot:SwitchOffAction"],
            "input": {
              "type": "boolean",
              "const": false
            },
            "forms": [
              {
                "href": "/example/light/currentswitch",
                "contentType": "application/json",
                "op": ["invokeaction"],
                "htv:methodName": "POST"
              }
            ]
          },
          "setBrightness": {
            "title": "Set Brightness Level",
            "@type": ["iot:SetLevelAction"],
            "input": {
              "type": "object",
              "properties": {
                "brightness": {
                  "@type": ["iot:LevelData"],
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 255
                  }
                },
                "transitionTime": {
                  "@type": ["iot:TransitionTimeData"],
                  "type": "integer",
                  "minimum": 0,
                  "maximum": 65535
                }
            },
            "forms": [
              {
                "href": "/example/light/",
                "contentType": "application/json",
                "op": ["invokeaction"],
                "htv:methodName": "POST"
              }
            ]
          }
        }
      }
    </pre>  
      </pre>
  </section>


  <section id="sec-security-considerations">
        <h1>Security and Privacy Considerations</h1>
        <p class="ednote">
          Security and privacy considerations are still under discussion and development; the content below should be
          considered preliminary.
          Due to the complexity of the subject
          we are considering producing a separate document containing a detailed security and privacy considerations
          discussion
          including a risk analysis,
          threat model,
          recommended mitigations,
          and appropriate references to best practices.
          A summary will be included here.
          Work in progress is located in the
          <a href="https://github.com/w3c/wot-security/">WoT Security and Privacy</a> repository.
          Please file any security or privacy considerations and/or concerns using the <a
            href="https://github.com/w3c/wot-security/issues">GitHub Issue</a> feature.
        </p>
        <p>
          <!-- Security requirements for the the WoT -->
          Security is a cross-cutting issue that needs to be taken into account in all WoT building blocks.
          The W3C WoT does not define any new security mechanisms,
          but provides guidelines to apply the best practices from
          Web security,
          IoT security,
          and information security for general software and hardware considerations.
        </p>
        <p>
          The <a
            href="https://github.com/w3c/wot-architecture/blob/master/terminology.md#user-content-thing-description-td">WoT
            Thing Description</a> must be used together with integrity protection mechanisms and access control
          policies.
          Users must ensure that no sensitive information is included in the <a
            href="https://github.com/w3c/wot-architecture/blob/master/terminology.md#user-content-td">TDs</a>
          themselves.
        </p>
        <p>
          The <a
            href="https://github.com/w3c/wot-architecture/blob/master/terminology.md#user-content-binding-templates">WoT
            Binding Templates</a> must correctly cover the security mechanisms employed by the underlying <a
            href="https://github.com/w3c/wot-architecture/blob/master/terminology.md#user-content-iot-platform">IoT
            platform</a>.
          Due to the automation of network interactions necessary in the IoT, operators need to ensure that <a
            href="https://github.com/w3c/wot-architecture/blob/master/terminology.md#user-content-thing">Things</a> are
          exposed and consumed in a way that is compliant with their security policies.
        </p>
        <p>
          The <a href="https://github.com/w3c/wot-architecture/blob/master/terminology.md#user-content-wot-runtime">WoT
            Runtime</a> implementation for the <a
            href="https://github.com/w3c/wot-architecture/blob/master/terminology.md#user-content-scripting-api">WoT
            Scripting API</a> must have mechanisms to prevent malicious access to the system and isolate scripts in
          multi-tenant <a
            href="https://github.com/w3c/wot-architecture/blob/master/terminology.md#user-content-servient">Servients</a>.
        </p>
    </section>

    <section id="appendix-example-sequences" class="appendix informative">
        <h1>Example Sequences of Interaction Affordances</h1>
        <p> This section illustrates example sequences of application and protocol
            transactions that correspond to operations 
            (defined in the Thing Description Specification)
            implementing various interactions among WoT Consumer and WoT Things.
            The illustrations show both the concrete protocol transactions
            and the interactions between the applications running
            inside the WoT Consumer and WoT Thing
            and the Consumed Thing and Exposed Thing abstractions.
        </p>
        <p> For the sake of simplicity, remote and local proxies
            between the Consumer and the Thing are omitted from the following sequences.
            We also assume HTTP as the concrete protocol
            and omit any additional transactions for implementing security,
            such as those that would be used for authentication or
            to set up a secure connection for HTTPS.
            Other concrete protocols and the addition of security transactions
            however would only affect the concrete protocol transactions,
            not the application-level interactions with the
            Consumed Thing and Exposed Thing abstractions.
        </p>
        <section>
            <h2>Property Interactions</h2>
            <section>
                <h3>Read property (HTTP binding)</h3>
                <p>The following sequence illustrates application and network
                   transactions to implement the 
                   <code>readproperty</code> operation
                   with an HTTP protocol binding.</p>
                <p>
                    <img
                        src="images/message-flows/A_1_1_readProperty.png"
                        alt="Read property (HTTP binding)" />
                </p>
            </section>
            <section>
                <h3>Write property (HTTP binding)</h3>
                <p>The following sequence illustrates application and network
                   transactions to implement the 
                   <code>writeproperty</code> operation
                   with an HTTP protocol binding.</p>
                <p>
                    <img
                        src="images/message-flows/A_1_2_writeProperty.png"
                        alt="Write property (HTTP binding)" />
                </p>
            </section>
            <section>
                <h3>Observe property (HTTP binding with Long Polling subprotocol)</h3>
                <p>The following sequence illustrates application and network
                   transactions to implement the 
                   <code>observeproperty</code> operation
                   with an HTTP protocol binding using 
                   the "longpolling" (Long Polling) subprotocol.</p>
                <p>
                    <img
                        src="images/message-flows/A_1_3a_observePropertyLongPoll.png"
                        alt="Observe property (HTTP binding with Long Polling subprotocol)" />
                </p>
            </section>
            <section>
                <h3>Observe property (HTTP binding with Server Sent Event subprotocol)</h3>
                <p>The following sequence illustrates application and network
                   transactions to implement the <code>observeproperty</code> operation
                   with an HTTP protocol binding using 
                   the "sse" (Server Sent Event) subprotocol.</p>
                <p>
                    <img
                        src="images/message-flows/A_1_3b_observePropertySSE.png"
                        alt="Observe property (HTTP binding with Server Sent Event subprotocol)" />
                </p>
            </section>
            <section>
                <h3>Observe property (HTTP binding with WebSocket subprotocol)</h3>
                <p>The following sequence illustrates application and network
                   transactions to implement the <code>observeproperty</code> operation
                   with an HTTP protocol binding using
                   a WebSocket-based subprotocol.</p>
                <p>
                    <img
                        src="images/message-flows/A_1_3c_observePropertyWebSocket.png"
                        alt="Observe property (HTTP binding with a WebSocket subprotocol)" />
                </p>
            </section>
        </section>
        <section>
            <h2>Action Interactions</h2>
            <section>
                <h3>Invoke action (HTTP binding)</h3>
                <p>The following sequence illustrates application and network
                   transactions to implement the 
                   <code>invokeaction</code> operation
                   with an HTTP protocol binding, where the
                   operation is synchronous and the response from the server
                   is delayed until after the action completes.</p>
                <p>
                    <img
                        src="images/message-flows/A_2_1_invokeAction.png"
                        alt="Invoke action (HTTP binding)" />
                </p>
                <!-- Note: Actions with asynchronous operation is
                     subject to further study.
                -->
            </section>
        </section>
        <section>
            <h2>Event Interactions</h2>
            <p>In the following, note that there is no explicit operation defined for event notification itself.
               The subprotocol used for notification is associated with 
               the <code>subscribeevent</code> operation, and any necessary concrete
               protocol transactions are managed by the Protocol Binding subsystem.
            </p>
            <p>There are also several subprotocols possible for event notification
               using WebSockets.
               The interaction diagrams show only one of several possible implementations.
            </p>
            <section>
                <h3>Subscribe, notify and unsubscribe event
                    (HTTP binding with Long Polling subprotocol)</h3>
                <p>The following sequence illustrates application and network
                   transactions to implement the 
                   <code>subscribeevent</code> and <code>unsubscribeevent</code> operations
                   with an HTTP protocol binding using  the Long Polling subprotocol.
                </p>
                <p>
                    <img
                        src="images/message-flows/A_3_1a_eventLongPoll.png"
                        alt="Subscribe, notify, and unsubscribe event (HTTP binding with Long Polling subprotocol)" />
                </p>
            </section>
            <section>
                <h3>Subscribe, notify and unsubscribe event
                    (HTTP binding with Server Sent Event subprotocol)</h3>
                <p>The following sequence illustrates application and network
                   transactions to implement the 
                   <code>subscribeevent</code> and <code>unsubscribeevent</code> operations
                   with an HTTP protocol binding using the Server Sent Event subprotocol.
                </p>
                <p>
                    <img src="images/message-flows/A_3_1b_eventSSE.png"
                        alt="Subscribe, notify and unsubscribe event (HTTP binding with Server Sent Event subprotocol)" />
                </p>
            </section>
            <section>
                <h3>Subscribe, notify and unsubscribe event
                    (HTTP binding with WebSocket subprotocol)</h3>
                <p>The following sequence illustrates application and network
                   transactions to implement the <code>subscribeevent</code> and <code>unsubscribeevent</code> operations
                   with an HTTP protocol binding using a WebSocket subprotocol.
                </p>
                <p>
                    <img
                        src="images/message-flows/A_3_1c_eventWebSocket.png"
                        alt="Subscribe, notify and unsubscribe event (HTTP binding with WebSocket subprotocol)" />
                </p>
            </section>
        </section>
    </section>


  <!-- <section class="appendix">
        <h2>Appendix</h2> -->
    <section id="sec-acknowledgements" class="appendix">
    <h2>Acknowledgements</h2>
    <p>
      Special thanks to all active participants of the W3C Web of Things Interest Group and Working Group
      for their technical input and suggestions that led to improvements to this document.
    </p>
    </section>

    <!-- <section id="references" class="appendix">
        <h1>References</h1>
      
        <dl class="bibliography">

          <dt id="bib-openapi">[OPENAPI]</dt>
          <dd><a href="https://swagger.io/specification/"><cite>OpenAPI Specification: Version 3.0.1</cite></a>. Darrel
            Miller;
            Jason Harmon; Jeremy Whitlock; Kris Hahn; Marsh Gardiner; Mike Ralphson; Rob Dolin; Ron Ratovsky; Tony Tam.
            OpenAPI
            Initiative, Linux Foundation. 7 December 2017. URL: <a
              href="https://swagger.io/specification/">https://swagger.io/specification/</a>

          </dd>
      
          <dt id="bib-link-relations">[IANA Link Relations]</dt>
          <dd><a href="https://www.iana.org/assignments/link-relations/link-relations.xhtml"><cite>Link Relations</cite></a>. IANA. URL: <a
              href="iana.org/assignments/link-relations/link-relations.xhtml">iana.org/assignments/link-relations/link-relations.xhtml</a>
          </dd>
      
          <dt id="bib-rfc6906">[RFC6906]</dt>
          <dd><a href="https://tools.ietf.org/html/rfc6906"><cite>The 'profile' Link Relation Type</cite></a>. E. Wilde;
            IETF. March 2013. Informational. URL: <a
              href="https://tools.ietf.org/html/rfc6906">https://tools.ietf.org/html/rfc6906</a>
          </dd>
          < A media type defines both the semantics and the serialization of a
                      specific type of content. In many cases, media types have some
                      built-in extensibility or openness, so that specific instances of the
                      media type can layer additional semantics on top of the media type's
                      foundation. In this case, a profile is the appropriate mechanism to
                      signal that the original semantics and processing model of the media
                      type still apply, but that an additional processing model can be used
                      to extract additional semantics. 
        </dl>
      

      </section> -->
  </section>
  <!--
    <section class="appendix">
      <h2>Change History</h2>
      <p>
        This is the First Public Working Draft.
      </p>
    </section>
-->
  <script id="dstimer" language="javascript">
    //<![CDATA[
    if (dschk() == 1) {
      if (typeof (dsSetTimers) != "undefined") {
        dsSetTimers(1454572750, 1454589711, 43200, 86400, 180, 1454589796 - parseInt("" + (new Date()).getTime() /
          1000), 1);
      }
    }
    //]]>
  </script>
</body>

</html>
